import{u as C}from"./BJTjakZ4.js";import{S as Y}from"./DZNpTO_H.js";import{d as E,r as y,t as v,L as g,A as _,z as u,aC as d,aS as A,aT as $,V as q,M as ee,v as k,Q as O,aV as te,S as K,ae as H,aD as Q,U as T,T as ne,B as W,y as re,c as Z,o as ae,W as le}from"./BX9kVcox.js";import{u as G,f as D,V as N,a as oe}from"./DaCI28AF.js";import{V as se}from"./CdgE0aOY.js";import"./DlAUqK2U.js";function U(e){"@babel/helpers - typeof";return U=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U(e)}function j(e){var t=typeof e=="string"||e instanceof String;if(!t){var n=U(e);throw e===null?n="null":n==="object"&&(n=e.constructor.name),new TypeError("Expected a string but received a ".concat(n))}}function J(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;for(var n in t)typeof e[n]>"u"&&(e[n]=t[n]);return e}var ce={require_tld:!0,allow_underscores:!1,allow_trailing_dot:!1,allow_numeric_tld:!1,allow_wildcard:!1,ignore_max_length:!1};function ie(e,t){j(e),t=J(t,ce),t.allow_trailing_dot&&e[e.length-1]==="."&&(e=e.substring(0,e.length-1)),t.allow_wildcard===!0&&e.indexOf("*.")===0&&(e=e.substring(2));var n=e.split("."),l=n[n.length-1];return t.require_tld&&(n.length<2||!t.allow_numeric_tld&&!/^([a-z\u00A1-\u00A8\u00AA-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}|xn[a-z0-9-]{2,})$/i.test(l)||/\s/.test(l))||!t.allow_numeric_tld&&/^\d+$/.test(l)?!1:n.every(function(a){return!(a.length>63&&!t.ignore_max_length||!/^[a-z_\u00a1-\uffff0-9-]+$/i.test(a)||/[\uff01-\uff5e]/.test(a)||/^-|-$/.test(a)||!t.allow_underscores&&/_/.test(a))})}var B="(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])",S="(".concat(B,"[.]){3}").concat(B),ue=new RegExp("^".concat(S,"$")),s="(?:[0-9a-fA-F]{1,4})",fe=new RegExp("^("+"(?:".concat(s,":){7}(?:").concat(s,"|:)|")+"(?:".concat(s,":){6}(?:").concat(S,"|:").concat(s,"|:)|")+"(?:".concat(s,":){5}(?::").concat(S,"|(:").concat(s,"){1,2}|:)|")+"(?:".concat(s,":){4}(?:(:").concat(s,"){0,1}:").concat(S,"|(:").concat(s,"){1,3}|:)|")+"(?:".concat(s,":){3}(?:(:").concat(s,"){0,2}:").concat(S,"|(:").concat(s,"){1,4}|:)|")+"(?:".concat(s,":){2}(?:(:").concat(s,"){0,3}:").concat(S,"|(:").concat(s,"){1,5}|:)|")+"(?:".concat(s,":){1}(?:(:").concat(s,"){0,4}:").concat(S,"|(:").concat(s,"){1,6}|:)|")+"(?::((?::".concat(s,"){0,5}:").concat(S,"|(?::").concat(s,"){1,7}|:))")+")(%[0-9a-zA-Z-.:]{1,})?$");function I(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return j(e),t=String(t),t?t==="4"?ue.test(e):t==="6"?fe.test(e):!1:I(e,4)||I(e,6)}function de(e,t){return ve(e)||_e(e,t)||pe(e,t)||me()}function me(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pe(e,t){if(e){if(typeof e=="string")return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}}function M(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,l=new Array(t);n<t;n++)l[n]=e[n];return l}function _e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var l,a,i,f,c=[],r=!0,o=!1;try{if(i=(n=n.call(e)).next,t!==0)for(;!(r=(l=i.call(n)).done)&&(c.push(l.value),c.length!==t);r=!0);}catch(m){o=!0,a=m}finally{try{if(!r&&n.return!=null&&(f=n.return(),Object(f)!==f))return}finally{if(o)throw a}}return c}}function ve(e){if(Array.isArray(e))return e}var ye={protocols:["http","https","ftp"],require_tld:!0,require_protocol:!1,require_host:!0,require_port:!1,require_valid_protocol:!0,allow_underscores:!1,allow_trailing_dot:!1,allow_protocol_relative_urls:!1,allow_fragments:!0,allow_query_components:!0,validate_length:!0},ge=/^\[([^\]]+)\](?::([0-9]+))?$/;function he(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function z(e,t){for(var n=0;n<t.length;n++){var l=t[n];if(e===l||he(l)&&l.test(e))return!0}return!1}function Se(e,t){if(j(e),!e||/[\s<>]/.test(e)||e.indexOf("mailto:")===0||(t=J(t,ye),t.validate_length&&e.length>=2083)||!t.allow_fragments&&e.includes("#")||!t.allow_query_components&&(e.includes("?")||e.includes("&")))return!1;var n,l,a,i,f,c,r,o;if(r=e.split("#"),e=r.shift(),r=e.split("?"),e=r.shift(),r=e.split("://"),r.length>1){if(n=r.shift().toLowerCase(),t.require_valid_protocol&&t.protocols.indexOf(n)===-1)return!1}else{if(t.require_protocol)return!1;if(e.slice(0,2)==="//"){if(!t.allow_protocol_relative_urls)return!1;r[0]=e.slice(2)}}if(e=r.join("://"),e==="")return!1;if(r=e.split("/"),e=r.shift(),e===""&&!t.require_host)return!0;if(r=e.split("@"),r.length>1){if(t.disallow_auth||r[0]===""||(l=r.shift(),l.indexOf(":")>=0&&l.split(":").length>2))return!1;var m=l.split(":"),p=de(m,2),w=p[0],F=p[1];if(w===""&&F==="")return!1}i=r.join("@"),c=null,o=null;var V=i.match(ge);if(V?(a="",o=V[1],c=V[2]||null):(r=i.split(":"),a=r.shift(),r.length&&(c=r.join(":"))),c!==null&&c.length>0){if(f=parseInt(c,10),!/^[0-9]+$/.test(c)||f<=0||f>65535)return!1}else if(t.require_port)return!1;return t.host_whitelist?z(a,t.host_whitelist):a===""&&!t.require_host?!0:!(!I(a)&&!ie(a,t)&&(!o||!I(o,6))||(a=a||o,t.host_blacklist&&z(a,t.host_blacklist)))}const X=E({__name:"ScannerForm",props:{scanner:{}},emits:["close-form"],setup(e,{emit:t}){var L,R,P;const n=e,l=y(),a=y(!1),i=t,f=C(),c=G(),r=y(((L=n.scanner)==null?void 0:L.endpoint)||""),o=y(((R=n.scanner)==null?void 0:R.name)||""),m=y(((P=n.scanner)==null?void 0:P.apiKey)||""),p={required:x=>x.trim()!==""||"",url:x=>Se(x)||"Must be a valid URL"},w=async()=>{if(a.value===!0)try{f.addOrUpdateScanner({endpoint:r.value,apiKey:m.value,name:o.value}),F(),i("close-form"),c.reportSuccess("Scanner saved successfully.")}catch{c.reportError("Failed to save scanner information. Please try again.")}},F=()=>{r.value="",o.value="",m.value=""},V=()=>{F(),i("close-form")};return(x,h)=>(v(),g(se,{ref_key:"form",ref:l,modelValue:d(a),"onUpdate:modelValue":h[3]||(h[3]=b=>A(a)?a.value=b:null),class:"mt-4",onSubmit:ee(w,["prevent"])},{default:_(()=>[u($,{modelValue:d(r),"onUpdate:modelValue":h[0]||(h[0]=b=>A(r)?r.value=b:null),variant:"outlined",density:"compact",label:"Scanner Endpoint",placeholder:"https://api.example.com/graphql",disabled:n.scanner!==null,rules:[p.required,p.url]},null,8,["modelValue","disabled","rules"]),u($,{modelValue:d(o),"onUpdate:modelValue":h[1]||(h[1]=b=>A(o)?o.value=b:null),variant:"outlined",density:"compact",label:"Scanner Name",placeholder:"Scanner Name",rules:[p.required]},null,8,["modelValue","rules"]),u($,{modelValue:d(m),"onUpdate:modelValue":h[2]||(h[2]=b=>A(m)?m.value=b:null),variant:"outlined",density:"compact",label:"API Key",placeholder:"Enter API Key",rules:[p.required]},null,8,["modelValue","rules"]),u(q,{class:"me-2",type:"submit",color:"success",text:"Save","prepend-icon":"mdi-check",disabled:!d(a)},null,8,["disabled"]),u(q,{text:"Cancel","prepend-icon":"mdi-close",onClick:V})]),_:1},8,["modelValue"]))}}),be=E({__name:"ScannerItem",props:{scanner:{}},setup(e){const t=e,n=y(!1),l=C(),a=G(),i=()=>{try{l.deleteScanner(t.scanner.endpoint),a.reportSuccess("Scanner deleted successfully.")}catch{a.reportError("Failed to delete scanner. Please try again.")}},f=()=>{n.value=!0},c=()=>{n.value=!1},r=[{title:"Edit",action:f,icon:"mdi-pencil-outline",color:"primary",divider:!0},{title:"Delete",action:i,icon:"mdi-delete",color:"red"}];return(o,m)=>(v(),k("div",null,[d(n)?(v(),g(X,{key:0,scanner:o.scanner,onCloseForm:c},null,8,["scanner"])):(v(),g(T,{key:1,title:o.scanner.name,subtitle:o.scanner.endpoint,"prepend-icon":"mdi-laptop",class:"mb-6"},{append:_(()=>[u(q,{variant:"flat"},{default:_(()=>[u(O,{icon:"mdi-dots-vertical"}),u(te,{activator:"parent",location:"bottom"},{default:_(()=>[u(K,null,{default:_(()=>[(v(),k(H,null,Q(r,(p,w)=>u(T,{key:`item-${p.title}-${w}`,onClick:p.action},{default:_(()=>[u(ne,null,{default:_(()=>[u(O,{start:"",icon:p.icon},null,8,["icon"]),W(" "+re(p.title),1)]),_:2},1024)]),_:2},1032,["onClick"])),64))]),_:1})]),_:1})]),_:1})]),_:1},8,["title","subtitle"]))]))}}),we=E({__name:"ScannersList",emits:["update-scanner"],setup(e,{emit:t}){const n=C(),l=Z(()=>n.scanners),a=t,i=f=>{a("update-scanner",f)};return(f,c)=>(v(),g(K,{lines:"one"},{default:_(()=>[(v(!0),k(H,null,Q(d(l),r=>(v(),g(be,{key:r.endpoint,scanner:r,onUpdateScanner:i},null,8,["scanner"]))),128))]),_:1}))}}),Ie=E({__name:"index",setup(e){const t=C(),n=Z(()=>t.scanners),l=y(!0),a=y(!1),i=y(null),f=[{text:"Scanning",disabled:!0,exact:!0},{text:"Scanners",disabled:!0,to:"/scanners",exact:!0}];ae(()=>{l.value=!1});const c=o=>{a.value=!0,i.value=o},r=()=>{a.value=!1,i.value=null};return(o,m)=>(v(),k("div",null,[u(d(oe),{breadcrumbs:f,class:"mb-5"}),u(N,{variant:"outlined",class:"my-4"},{default:_(()=>[u(D,null,{default:_(()=>[d(a)?(v(),g(X,{key:1,scanner:d(i),onCloseForm:r},null,8,["scanner"])):(v(),g(q,{key:0,color:"primary","prepend-icon":"mdi-plus",onClick:m[0]||(m[0]=p=>a.value=!d(a))},{default:_(()=>[W(" New ")]),_:1}))]),_:1})]),_:1}),d(l)===!0?(v(),g(Y,{key:0})):d(l)===!1&&d(n).length>0?(v(),g(N,{key:1,variant:"outlined"},{default:_(()=>[u(D,null,{default:_(()=>[u(we,{onUpdateScanner:c})]),_:1})]),_:1})):le("",!0)]))}});export{Ie as default};
