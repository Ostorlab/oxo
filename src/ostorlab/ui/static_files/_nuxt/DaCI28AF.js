import{Z as $,b3 as S,a2 as I,a9 as V,z as n,ca as ae,aq as w,cb as te,c as D,ad as Ce,b1 as P,ap as q,b4 as ne,a3 as Se,a4 as x,ar as le,bA as re,at as se,Q as _,bC as E,ae as g,P as F,bu as Ie,ax as G,b2 as Ve,$ as Te,a0 as Be,bh as _e,bv as $e,bw as xe,a1 as Ae,b6 as De,cc as Pe,a7 as we,cd as Ne,bx as Le,a5 as Re,a6 as je,bi as ze,by as Ee,bz as Oe,aE as Me,bO as Fe,ay as H,bj as He,bB as qe,d as ie,t as u,L as m,A as c,B as k,y as b,v as h,W as B,X as Q,aA as Ue,C as We,D as Ge,x as C,ce as Qe,cf as j,i as Xe,aV as X,V as M,S as Z,aD as J,U as K,T as A,R as Y}from"./BX9kVcox.js";import{_ as de}from"./DlAUqK2U.js";const Ze=$({divider:[Number,String],...S()},"VBreadcrumbsDivider"),Je=I()({name:"VBreadcrumbsDivider",props:Ze(),setup(e,s){let{slots:a}=s;return V(()=>{var l;return n("li",{class:["v-breadcrumbs-divider",e.class],style:e.style},[((l=a==null?void 0:a.default)==null?void 0:l.call(a))??e.divider])}),{}}}),Ke=$({active:Boolean,activeClass:String,activeColor:String,color:String,disabled:Boolean,title:String,...S(),...ae(),...w({tag:"li"})},"VBreadcrumbsItem"),ce=I()({name:"VBreadcrumbsItem",props:Ke(),setup(e,s){let{slots:a,attrs:l}=s;const y=te(e,l),o=D(()=>{var i;return e.active||((i=y.isActive)==null?void 0:i.value)}),d=D(()=>o.value?e.activeColor:e.color),{textColorClasses:r,textColorStyles:t}=Ce(d);return V(()=>n(e.tag,{class:["v-breadcrumbs-item",{"v-breadcrumbs-item--active":o.value,"v-breadcrumbs-item--disabled":e.disabled,[`${e.activeClass}`]:o.value&&e.activeClass},r.value,e.class],style:[t.value,e.style],"aria-current":o.value?"page":void 0},{default:()=>{var i,v;return[y.isLink.value?n("a",{class:"v-breadcrumbs-item--link",href:y.href.value,"aria-current":o.value?"page":void 0,onClick:y.navigate},[((v=a.default)==null?void 0:v.call(a))??e.title]):((i=a.default)==null?void 0:i.call(a))??e.title]}})),{}}}),Ye=$({activeClass:String,activeColor:String,bgColor:String,color:String,disabled:Boolean,divider:{type:String,default:"/"},icon:P,items:{type:Array,default:()=>[]},...S(),...q(),...ne(),...w({tag:"ul"})},"VBreadcrumbs"),ea=I()({name:"VBreadcrumbs",props:Ye(),setup(e,s){let{slots:a}=s;const{backgroundColorClasses:l,backgroundColorStyles:y}=Se(x(e,"bgColor")),{densityClasses:o}=le(e),{roundedClasses:d}=re(e);se({VBreadcrumbsDivider:{divider:x(e,"divider")},VBreadcrumbsItem:{activeClass:x(e,"activeClass"),activeColor:x(e,"activeColor"),color:x(e,"color"),disabled:x(e,"disabled")}});const r=D(()=>e.items.map(t=>typeof t=="string"?{item:{title:t},raw:t}:{item:t,raw:t}));return V(()=>{const t=!!(a.prepend||e.icon);return n(e.tag,{class:["v-breadcrumbs",l.value,o.value,d.value,e.class],style:[y.value,e.style]},{default:()=>{var i;return[t&&n("li",{key:"prepend",class:"v-breadcrumbs__prepend"},[a.prepend?n(E,{key:"prepend-defaults",disabled:!e.icon,defaults:{VIcon:{icon:e.icon,start:!0}}},a.prepend):n(_,{key:"prepend-icon",start:!0,icon:e.icon},null)]),r.value.map((v,f,N)=>{var L;let{item:T,raw:O}=v;return n(g,null,[((L=a.item)==null?void 0:L.call(a,{item:T,index:f}))??n(ce,F({key:f,disabled:f>=N.length-1},typeof T=="string"?{title:T}:T),{default:a.title?()=>{var p;return(p=a.title)==null?void 0:p.call(a,{item:T,index:f})}:void 0}),f<N.length-1&&n(Je,null,{default:a.divider?()=>{var p;return(p=a.divider)==null?void 0:p.call(a,{item:O,index:f})}:void 0})])}),(i=a.default)==null?void 0:i.call(a)]}})}),{}}}),aa=I()({name:"VCardActions",props:S(),setup(e,s){let{slots:a}=s;return se({VBtn:{slim:!0,variant:"text"}}),V(()=>{var l;return n("div",{class:["v-card-actions",e.class],style:e.style},[(l=a.default)==null?void 0:l.call(a)])}),{}}}),ta=$({opacity:[Number,String],...S(),...w()},"VCardSubtitle"),na=I()({name:"VCardSubtitle",props:ta(),setup(e,s){let{slots:a}=s;return V(()=>n(e.tag,{class:["v-card-subtitle",e.class],style:[{"--v-card-subtitle-opacity":e.opacity},e.style]},a)),{}}}),la=Ie("v-card-title"),ra=$({appendAvatar:String,appendIcon:P,prependAvatar:String,prependIcon:P,subtitle:[String,Number],title:[String,Number],...S(),...q()},"VCardItem"),sa=I()({name:"VCardItem",props:ra(),setup(e,s){let{slots:a}=s;return V(()=>{var i;const l=!!(e.prependAvatar||e.prependIcon),y=!!(l||a.prepend),o=!!(e.appendAvatar||e.appendIcon),d=!!(o||a.append),r=!!(e.title!=null||a.title),t=!!(e.subtitle!=null||a.subtitle);return n("div",{class:["v-card-item",e.class],style:e.style},[y&&n("div",{key:"prepend",class:"v-card-item__prepend"},[a.prepend?n(E,{key:"prepend-defaults",disabled:!l,defaults:{VAvatar:{density:e.density,image:e.prependAvatar},VIcon:{density:e.density,icon:e.prependIcon}}},a.prepend):n(g,null,[e.prependAvatar&&n(G,{key:"prepend-avatar",density:e.density,image:e.prependAvatar},null),e.prependIcon&&n(_,{key:"prepend-icon",density:e.density,icon:e.prependIcon},null)])]),n("div",{class:"v-card-item__content"},[r&&n(la,{key:"title"},{default:()=>{var v;return[((v=a.title)==null?void 0:v.call(a))??e.title]}}),t&&n(na,{key:"subtitle"},{default:()=>{var v;return[((v=a.subtitle)==null?void 0:v.call(a))??e.subtitle]}}),(i=a.default)==null?void 0:i.call(a)]),d&&n("div",{key:"append",class:"v-card-item__append"},[a.append?n(E,{key:"append-defaults",disabled:!o,defaults:{VAvatar:{density:e.density,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon}}},a.append):n(g,null,[e.appendIcon&&n(_,{key:"append-icon",density:e.density,icon:e.appendIcon},null),e.appendAvatar&&n(G,{key:"append-avatar",density:e.density,image:e.appendAvatar},null)])])])}),{}}}),ia=$({opacity:[Number,String],...S(),...w()},"VCardText"),da=I()({name:"VCardText",props:ia(),setup(e,s){let{slots:a}=s;return V(()=>n(e.tag,{class:["v-card-text",e.class],style:[{"--v-card-text-opacity":e.opacity},e.style]},a)),{}}}),ca=$({appendAvatar:String,appendIcon:P,disabled:Boolean,flat:Boolean,hover:Boolean,image:String,link:{type:Boolean,default:void 0},prependAvatar:String,prependIcon:P,ripple:{type:[Boolean,Object],default:!0},subtitle:[String,Number],text:[String,Number],title:[String,Number],...Ve(),...S(),...q(),...Te(),...Be(),..._e(),...$e(),...xe(),...ne(),...ae(),...w(),...Ae(),...De({variant:"elevated"})},"VCard"),oa=I()({name:"VCard",directives:{Ripple:Pe},props:ca(),setup(e,s){let{attrs:a,slots:l}=s;const{themeClasses:y}=we(e),{borderClasses:o}=Ne(e),{colorClasses:d,colorStyles:r,variantClasses:t}=Le(e),{densityClasses:i}=le(e),{dimensionStyles:v}=Re(e),{elevationClasses:f}=je(e),{loaderClasses:N}=ze(e),{locationStyles:T}=Ee(e),{positionClasses:O}=Oe(e),{roundedClasses:L}=re(e),p=te(e,a),ue=D(()=>e.link!==!1&&p.isLink.value),R=D(()=>!e.disabled&&e.link!==!1&&(e.link||p.isClickable.value));return V(()=>{const ve=ue.value?"a":e.tag,fe=!!(l.title||e.title!=null),ye=!!(l.subtitle||e.subtitle!=null),be=fe||ye,ke=!!(l.append||e.appendAvatar||e.appendIcon),me=!!(l.prepend||e.prependAvatar||e.prependIcon),ge=!!(l.image||e.image),pe=be||me||ke,he=!!(l.text||e.text!=null);return Me(n(ve,{class:["v-card",{"v-card--disabled":e.disabled,"v-card--flat":e.flat,"v-card--hover":e.hover&&!(e.disabled||e.flat),"v-card--link":R.value},y.value,o.value,d.value,i.value,f.value,N.value,O.value,L.value,t.value,e.class],style:[r.value,v.value,T.value,e.style],href:p.href.value,onClick:R.value&&p.navigate,tabindex:e.disabled?-1:void 0},{default:()=>{var U;return[ge&&n("div",{key:"image",class:"v-card__image"},[l.image?n(E,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{cover:!0,src:e.image}}},l.image):n(H,{key:"image-img",cover:!0,src:e.image},null)]),n(He,{name:"v-card",active:!!e.loading,color:typeof e.loading=="boolean"?void 0:e.loading},{default:l.loader}),pe&&n(sa,{key:"item",prependAvatar:e.prependAvatar,prependIcon:e.prependIcon,title:e.title,subtitle:e.subtitle,appendAvatar:e.appendAvatar,appendIcon:e.appendIcon},{default:l.item,prepend:l.prepend,title:l.title,subtitle:l.subtitle,append:l.append}),he&&n(da,{key:"text"},{default:()=>{var W;return[((W=l.text)==null?void 0:W.call(l))??e.text]}}),(U=l.default)==null?void 0:U.call(l),l.actions&&n(aa,null,{default:l.actions}),qe(R.value,"v-card")]}}),[[Fe("ripple"),R.value&&e.ripple]])}),{}}});var Ia=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ua(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var z={exports:{}};(function(){var e=[],s=3988292384;function a(){var d,r,t;for(r=0;r<256;r+=1){for(d=r,t=0;t<8;t+=1)d&1?d=s^d>>>1:d=d>>>1;e[r]=d>>>0}}function l(d){return Array.prototype.map.call(d,function(r){return r.charCodeAt(0)})}function y(d){var r=-1,t,i,v,f;for(t=0,v=d.length;t<v;t+=1){for(f=(r^d[t])&255,i=0;i<8;i+=1)(f&1)===1?f=f>>>1^s:f=f>>>1;r=r>>>8^f}return r^-1}function o(d,r){var t,i,v;if(!((typeof o.crc>"u"||!r||!d)&&(o.crc=-1,!d))){for(t=o.crc,i=0,v=d.length;i<v;i+=1)t=t>>>8^e[(t^d[i])&255];return o.crc=t,t^-1}}a(),z.exports=function(t,r){var t=typeof t=="string"?l(t):t,i=r?y(t):o(t);return(i>>>0).toString(16)},z.exports.direct=y,z.exports.table=o})();var va=z.exports;const ee=ua(va),fa=ie({name:"DfRisk",props:{risk:{type:String,required:!0},size:{type:String,default:"small"},cvssScore:{type:Number,default:null},variant:{type:String,default:"flat"},close:{type:Boolean,default:!1},reverse:{type:Boolean,default:!1}},emits:["closeRiskRating"],computed:{colorText(){if(this.risk)switch(this.risk.toLowerCase()){case"critical":return{color:"grey-darken-4",text:"Critical"};case"high":return{color:"red",text:"High"};case"medium":return{color:"orange-darken-1",text:"Medium"};case"low":return{color:"yellow-darken-1",text:"Low"};case"potentially":return{color:"grey",text:"Potentially"};case"hardening":return{color:"purple",text:"Hardening"};case"secure":return{color:"green-darken-4",text:"Secure"};case"info":return{color:"blue-lighten-1",text:"Info"};case"important":return{color:"green-darken-1",text:"Important"}}return{color:"grey-lighten",text:"Unknown"}}}}),oe=e=>(We("data-v-2dfc9837"),e=e(),Ge(),e),ya=oe(()=>C("span",{class:"mx-2"},"|",-1)),ba=oe(()=>C("span",{class:"mx-2"},"|",-1));function ka(e,s,a,l,y,o){return e.reverse===!1?(u(),m(Q,{key:0,color:e.colorText.color,size:e.size,variant:e.variant,label:"",close:e.close,"onClick:close":s[0]||(s[0]=d=>e.$emit("closeRiskRating",e.risk))},{default:c(()=>[k(b(e.colorText.text)+" ",1),e.cvssScore!==null?(u(),h(g,{key:0},[ya,k(b(e.cvssScore),1)],64)):B("",!0)]),_:1},8,["color","size","variant","close"])):(u(),m(Q,{key:1,color:"white",size:e.size,variant:e.variant,var:"",label:"",class:Ue([`${e.colorText.color}-text`]),close:e.close,"onClick:close":s[1]||(s[1]=d=>e.$emit("closeRiskRating",e.risk))},{default:c(()=>[k(b(e.colorText.text),1),e.cvssScore!==null?(u(),h(g,{key:0},[ba,k(b(e.cvssScore),1)],64)):B("",!0)]),_:1},8,["size","variant","class","close"]))}const ma=de(fa,[["render",ka],["__scopeId","data-v-2dfc9837"]]),Va=Qe("notifications",{actions:{reportError(e){j.error(e)},reportSuccess(e){j.success(e)},reportInfo(e){j.info(e)},reportWarning(e){j.warning(e)}}}),ga=ie({name:"DfBreadcrumbs",components:{DfRisk:ma},props:{breadcrumbs:{type:Array,default:()=>[]},scanId:{type:String,default:null},vulnTitle:{type:String,default:null},scanner:{type:Object,default:null}},computed:{filteredBreadcrumbs(){return(this.breadcrumbs||[]).map(e=>{if(Object.keys(e).includes("scans")===!0){const s=((e==null?void 0:e.scans)||[]).findIndex(a=>a.id===this.scanId);if(s!==0&&s!==-1){const a=((e==null?void 0:e.scans)||[]).splice(s,1)[0];((e==null?void 0:e.scans)||[]).unshift(a)}}if(Object.keys(e).includes("kbvulnerabilities")===!0){const s=((e==null?void 0:e.kbvulnerabilities)||[]).findIndex(a=>{var l;return(a==null?void 0:a.key)===this.vulnTitle||((l=a==null?void 0:a.kb)==null?void 0:l.id)===this.vulnTitle});if(s!==0&&s!==-1){const a=((e==null?void 0:e.kbvulnerabilities)||[]).splice(s,1)[0];((e==null?void 0:e.kbvulnerabilities)||[]).unshift(a)}}return e})}},methods:{constructScanDetailLink(e){return this.scanner!==null?`/scan/${ee(this.scanner.endpoint)}/${e.id}`:`/scan/${e.id}`},constructVulnDetailLink(e){return this.scanner!==null?`/scan/${ee(this.scanner.endpoint)}/${this.scanId}/vuln/${e.key??e.kb.id}`:e.goToVulnId===!0?`/scan/${this.scanId}/vuln/id/${e.key}`:`/scan/${this.scanId}/vuln/${e.kb.id}`},getScanTitle(e){var s,a,l;return(e==null?void 0:e.packageName)!==null&&(e==null?void 0:e.packageName)!==void 0?(e==null?void 0:e.version)===null?e.packageName:`${e.packageName}:${e.version}`:((s=e==null?void 0:e.asset)==null?void 0:s.packageName)!==null&&((a=e==null?void 0:e.asset)==null?void 0:a.packageName)!==void 0?(l=e==null?void 0:e.asset)==null?void 0:l.packageName:(e==null?void 0:e.assetType)!==null&&(e==null?void 0:e.assetType)!==void 0?e==null?void 0:e.assetType:(e==null?void 0:e.title)!==void 0&&(e==null?void 0:e.title)!==null?e.title:`Scan ${e.id}`}}}),pa={class:"d-flex align-center"};function ha(e,s,a,l,y,o){const d=Xe("DfRisk");return u(),m(oa,{variant:"outlined"},{default:c(()=>[n(ea,{items:e.filteredBreadcrumbs,divider:">",class:"pa-1 ml-0"},{item:c(({item:r})=>[n(ce,{href:r.href,disabled:r.disabled,class:"pa-0"},{default:c(()=>[(r.scans||[]).length>0?(u(),m(X,{key:0,"offset-y":"","max-height":"680"},{activator:c(({props:t})=>[n(M,F({color:"primary"},t,{variant:"text","active-class":"no-active"}),{default:c(()=>[k(b(r.text)+" ",1),n(_,{end:""},{default:c(()=>[k(" mdi-menu-down ")]),_:1})]),_:2},1040)]),default:c(()=>[n(Z,{density:"compact"},{default:c(()=>[(u(!0),h(g,null,J(r.scans,(t,i)=>(u(),h("div",{key:`scan-${i}`},[n(K,{to:e.constructScanDetailLink(t)},{default:c(()=>[n(A,null,{default:c(()=>[C("code",null,b(e.getScanTitle(t)),1)]),_:2},1024),t.assetType==="android"||t.assetType==="ios"?(u(),h(g,{key:0},[t.b64Icon!==void 0&&t.b64Icon.length>0?(u(),m(H,{key:0,src:`data:image/png;base64,${t.b64Icon}`,alt:"Icon"},null,8,["src"])):B("",!0),n(A,null,{default:c(()=>[C("code",null,b(e.getScanTitle(t)),1)]),_:2},1024)],64)):t.assetType==="android_store"||t.assetType==="ios_store"?(u(),h(g,{key:1},[t.b64Icon!==void 0&&t.b64Icon.length>0?(u(),m(H,{key:0,src:`data:image/png;base64,${t.b64Icon}`,alt:"Icon"},null,8,["src"])):B("",!0),n(A,null,{default:c(()=>[C("code",null,b(e.getScanTitle(t)),1)]),_:2},1024)],64)):t.assetType==="web"?(u(),h(g,{key:2},[n(_,null,{default:c(()=>[k("mdi-web")]),_:1}),n(A,null,{default:c(()=>[C("code",null,b(t.asset.urls.join(",")),1)]),_:2},1024)],64)):t.assetType==="network"?(u(),h(g,{key:3},[n(_,null,{default:c(()=>[k("mdi-ip")]),_:1}),n(A,null,{default:c(()=>[C("code",null,b(t.asset.networks.join(",")),1)]),_:2},1024)],64)):B("",!0)]),_:2},1032,["to"]),i===0&&(r.scans||[]).length>1?(u(),m(Y,{key:0,class:"mb-2"})):B("",!0)]))),128))]),_:2},1024)]),_:2},1024)):(r.kbvulnerabilities||[]).length>0?(u(),m(X,{key:1,"offset-y":"","max-height":"680"},{activator:c(({props:t})=>[n(M,F({color:"primary"},t,{variant:"text","active-class":"no-active"}),{default:c(()=>[k(b(r.text),1),n(_,{end:""},{default:c(()=>[k(" mdi-menu-down ")]),_:1})]),_:2},1040)]),default:c(()=>[n(Z,{density:"compact"},{default:c(()=>[(u(!0),h(g,null,J(r.kbvulnerabilities,(t,i)=>(u(),h("div",{key:`vuln-${i}`},[(u(),m(K,{key:i,to:e.constructVulnDetailLink(t)},{default:c(()=>[C("div",pa,[n(d,{risk:t.risk,small:""},null,8,["risk"]),n(A,{class:"ml-2"},{default:c(()=>[k(b(t.title),1)]),_:2},1024)])]),_:2},1032,["to"])),i===0?(u(),m(Y,{key:0,class:"mb-2"})):B("",!0)]))),128))]),_:2},1024)]),_:2},1024)):(u(),m(M,{key:2,color:"primary",variant:"text",to:r.to,"active-class":"no-active"},{default:c(()=>[k(b(r.text),1)]),_:2},1032,["to"]))]),_:2},1032,["href","disabled"])]),_:1},8,["items"])]),_:1})}const Ta=de(ga,[["render",ha],["__scopeId","data-v-6e0861a1"]]);export{ma as D,oa as V,Ta as a,la as b,ee as c,aa as d,Ia as e,da as f,ua as g,Va as u};
